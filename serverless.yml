frameworkVersion: "2"
service: lambda-fn-mhw
provider:
  name: aws
  ecr:
    images:
      appimage:
        path: ./
  vpc: none
  role: arn:aws:iam::665407732775:role/LambdaBasicExecution
  runtime: nodejs14.x
  region: sa-east-1
  stage: prod
  deploymentBucket:
    name: com.serverless.${self:provider.region}.functions.mhw
  timeout: 30
  memorySize: 2048
  versionFunctions: true
  iamRoleStatements:
    - Effect: Allow
      Action:
        - lambda:InvokeFunction
        - lambda:InvokeAsync
      Resource: arn:aws:lambda:sa-east-1:665407732775:function:lambda-fn-mhw-refactoring-prod-generateRoutine
  environment:
    SERVER_ENV: production
    DB_URI: mongodb+srv://josue:lospajaroscantanmientraslospecesnadan@heroku-28zqn5s2.htt13.mongodb.net/heroku_28zqn5s2?retryWrites=true&w=majority
    DB_NAME: heroku_28zqn5s2
functions:
  generateRoutine:
    image:
      name: appimage
      command:
        - index.generateRoutine
      entryPoint:
        - '/lambda-entrypoint.sh'
  generate:
    image:
      name: appimage
      command:
        - index.generate
      entryPoint:
        - '/lambda-entrypoint.sh'
    events:
      - http: PUT /generate
  read:
    image:
      name: appimage
      command:
        - index.read
      entryPoint:
        - '/lambda-entrypoint.sh'
    events:
      - http: POST /read
